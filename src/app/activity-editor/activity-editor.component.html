<div class="progress-spinner" *ngIf="progress">
  <p-progressSpinner styleClass="w-4rem h-4rem" strokeWidth="8" fill="var(--surface-ground)" animationDuration=".5s"></p-progressSpinner>
</div>

<p-toast></p-toast>
<h2><img src="assets/logo.png" alt="" style="width:200px"/>&nbsp;&nbsp;Remote Two configuration toolkit</h2>
<p-menubar [model]="items">
  <ng-template pTemplate="end">
    <p-dropdown [(ngModel)]="selectedRemote" [options]="remotes" placeholder="Select remote" (ngModelChange)="setRemote(selectedRemote!)">
      <ng-template pTemplate="selectedItem">
        <ng-container *ngIf="selectedRemote">{{selectedRemote.remote_name}} ({{selectedRemote.address}})</ng-container>
        <ng-container *ngIf="!selectedRemote">No remote selected</ng-container>
      </ng-template>
      <ng-template let-item pTemplate="item">
        {{item.remote_name}} ({{item.address}})
      </ng-template>
    </p-dropdown>
  </ng-template>
</p-menubar>
<ng-container *ngIf="progress">
  {{progressDetail}}<br>
  <p-progressBar [value]="Math.round(remoteProgress)"></p-progressBar>
</ng-container>
<ng-container *ngFor="let template of templates">
  Apply mapping to a {{template.entity_type}} :
  <p-dropdown [options]="getEntities(template.entity_type)" [(ngModel)]="selectedEntity"
              [placeholder]="template.entity_type" (ngModelChange)="loadTemplate()">
    <ng-template pTemplate="selectedItem">
      {{selectedEntity?.name}} ({{selectedEntity?.entity_id}})
    </ng-template>
    <ng-template let-item pTemplate="item">
      <div>{{item.name}} ({{item.entity_id}})</div>
    </ng-template>
  </p-dropdown>
</ng-container>
<ng-container *ngIf="selectedEntity">&nbsp;Select features to map :
  <p-multiSelect [options]="availableFeatures" [(ngModel)]="selectedFeatures" optionLabel="label"></p-multiSelect>
  <br><div><p-checkbox [(ngModel)]="overwriteAssignedButtons" [binary]="true" label="Overwrite assigned physical buttons"></p-checkbox></div>
  <div><p-checkbox [(ngModel)]="keepDefinedPositions" [binary]="true" label="Preserve defined interface buttons"></p-checkbox></div>
  <br>
</ng-container>
{{activity_id}}<br>
<p-button label="Apply mapping" (onClick)="applyTemplate(this.updatedActivity!);viewer.view(updatedActivity!)"></p-button>
<ng-container *ngIf="dump">
  <ngx-json-viewer [json]="dump"></ngx-json-viewer>
</ng-container>
<app-activity-viewer #viewer [remote]="selectedRemote"></app-activity-viewer>

